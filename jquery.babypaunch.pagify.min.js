
$.fn.pagify=function(setting){"use strict";var config={current:1,total:0,pager:10,isText:true,combo:[10,20,30,50],list:20,showListed:false,showCombo:true,showPrevNext:true,showFirstEnd:true,attr:"index",classes:{first:"first",prev:"prev",current:"on",next:"next",end:"end"}};var method={first:function(min){return{[config.attr]:min-1,"text":min};},prev:function(num,min){var _prev=(num-1)*config.pager-config.pager+1;return _prev<min?{[config.attr]:min-1,"text":min}:{[config.attr]:_prev-1,"text":_prev};},from:function(num){return num===1?1:num*config.pager-config.pager+1;},to:function(num){return num===1?config.pager:num*config.pager;},next:function(num,max){var _next=num*config.pager+1;return _next>max?{[config.attr]:max-1,"text":max}:{[config.attr]:_next-1,"text":_next};},end:function(max){return{[config.attr]:max-1,"text":max};},result:function(){var listed=Math.ceil(config.total/Number(config.list));var paged=Math.ceil(listed/config.pager);var json={listed:listed,paged:paged};for(var i=0;i<=paged;i++){var fromTo=[];var inPaged=false;for(var j=this.from(i),num=j-1;j<=this.to(i);j++,num++){if(j<=listed){if(j===config.current){inPaged=true;}
fromTo.push({[config.attr]:num,"text":j,"isCurrent":j===config.current});}}
if(inPaged){if(config.showFirstEnd&&paged>1&&config.current!==1){json.first=this.first(1);}
if(config.showPrevNext&&config.current>config.pager){json.prev=this.prev(i,1);}
json.fromTo=fromTo;if(config.showPrevNext&&this.next(i,listed).text<this.end(listed).text){json.next=this.next(i,listed);}
if(config.showFirstEnd&&paged>1&&config.current!==listed){json.end=this.end(listed);}}}
return json;}};var ui={listed:function(total){return"<span>"+total+"</span>";},pager:function(config,dataset){var str="";var listed=dataset.listed;if(config.isText&&config.showListed){str+=this.listed(listed)+" ";}
for(var i in dataset){var data=dataset[i];var attr=config.attr;var classes=config.classes;if(i==="first"){str+="<a href='#' data-"+attr+"='"+data[attr]+"' class='"+classes.first+"'> ≪ </a>\n";}
if(i==="prev"){str+="<a href='#' data-"+attr+"='"+data[attr]+"' class='"+classes.prev+"'> ＜ </a>\n";}
if(i==="fromTo"){for(var j=0;j<data.length;j++){var _data=data[j];if(config.isText){var _current=_data.isCurrent?"["+_data.text+"]":_data.text;var _currentClass=_data.isCurrent?classes.current:"";str+="<a href='#' data-"+attr+"='"+_data[attr]+"' class='"+_currentClass+"'> "+_current+" </a>\n";}else{if(_data.isCurrent){str+="<input type='number' min='1' max='"+listed+"' data-"+attr+"='"+_data[attr]+"' value='"+_data.text+"'/>\n";if(config.showListed){str+=" / "+this.listed(listed);}}}}}
if(i==="next"){str+="<a href='#' data-"+attr+"='"+data[attr]+"' class='"+classes.next+"'> ＞ </a>\n";}
if(i==="end"){str+="<a href='#' data-"+attr+"='"+data[attr]+"' class='"+classes.end+"'> ≫ </a>\n";}}
return str;},select:function(config){var str="";if(config.showCombo){str+="<select>\n";for(var i=0,combo=config.combo;i<combo.length;i++){str+="\t<option value='"+combo[i]+"'"+(Number(config.list)===combo[i]?" selected='selected'":"")+">"
+combo[i]
+"</option>\n";}
str+="</select>\n";}
return str;}};$.extend(config,setting);var dataset=method.result();return this.each(function(){var html="";html+=ui.pager(config,dataset);html+=ui.select(config);$(this).html(html);});}
